--[[
    TugaHub Interface (Parte 1/2)
    Portuguese Hub System
    Modified by Portuga_MTA
    (Core + UI + Tabs + Elements begin)
]]

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")

-- TugaHub Library
local TugaHub = {
    Flags = {},
    Windows = {},
    Version = "2.0.0"
}

-- Color Themes
TugaHub.Themes = {
    Portugal = {
        Background = Color3.fromRGB(12, 18, 28),
        Surface = Color3.fromRGB(20, 28, 40),
        Sidebar = Color3.fromRGB(16, 22, 32),
        Primary = Color3.fromRGB(215, 40, 40),
        Secondary = Color3.fromRGB(0, 102, 51),
        Accent = Color3.fromRGB(255, 204, 0),
        Text = Color3.fromRGB(245, 245, 250),
        TextDim = Color3.fromRGB(160, 165, 180),
        Border = Color3.fromRGB(40, 50, 65),
        Success = Color3.fromRGB(46, 204, 113),
        Warning = Color3.fromRGB(241, 196, 15),
        Error = Color3.fromRGB(231, 76, 60)
    },
    Dark = {
        Background = Color3.fromRGB(15, 15, 20),
        Surface = Color3.fromRGB(22, 22, 30),
        Sidebar = Color3.fromRGB(18, 18, 25),
        Primary = Color3.fromRGB(88, 101, 242),
        Secondary = Color3.fromRGB(114, 137, 218),
        Accent = Color3.fromRGB(255, 115, 250),
        Text = Color3.fromRGB(240, 240, 245),
        TextDim = Color3.fromRGB(150, 150, 165),
        Border = Color3.fromRGB(35, 35, 45),
        Success = Color3.fromRGB(67, 181, 129),
        Warning = Color3.fromRGB(250, 166, 26),
        Error = Color3.fromRGB(240, 71, 71)
    },
    Light = {
        Background = Color3.fromRGB(248, 249, 252),
        Surface = Color3.fromRGB(255, 255, 255),
        Sidebar = Color3.fromRGB(250, 251, 254),
        Primary = Color3.fromRGB(88, 101, 242),
        Secondary = Color3.fromRGB(114, 137, 218),
        Accent = Color3.fromRGB(255, 115, 250),
        Text = Color3.fromRGB(30, 35, 45),
        TextDim = Color3.fromRGB(100, 110, 130),
        Border = Color3.fromRGB(220, 225, 235),
        Success = Color3.fromRGB(67, 181, 129),
        Warning = Color3.fromRGB(250, 166, 26),
        Error = Color3.fromRGB(240, 71, 71)
    }
}

local CurrentTheme = TugaHub.Themes.Portugal

-- Toggle key (configurable)
local ToggleKey = Enum.KeyCode.K

-- Utility Functions
local function Tween(obj, props, duration, style, direction)
    local tween = TweenService:Create(
        obj,
        TweenInfo.new(duration or 0.3, style or Enum.EasingStyle.Quad, direction or Enum.EasingDirection.Out),
        props
    )
    tween:Play()
    return tween
end

local function CreateCorner(parent, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 8)
    corner.Parent = parent
    return corner
end

local function CreateStroke(parent, color, thickness, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color
    stroke.Thickness = thickness or 1
    stroke.Transparency = transparency or 0
    stroke.Parent = parent
    return stroke
end

local function CreatePadding(parent, all)
    local padding = Instance.new("UIPadding")
    if all then
        padding.PaddingTop = UDim.new(0, all)
        padding.PaddingBottom = UDim.new(0, all)
        padding.PaddingLeft = UDim.new(0, all)
        padding.PaddingRight = UDim.new(0, all)
    end
    padding.Parent = parent
    return padding
end

local function MakeDraggable(frame, dragArea)
    local dragging, dragInput, dragStart, startPos
    dragArea = dragArea or frame

    dragArea.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    dragArea.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Tween(frame, {
                Position = UDim2.new(
                    startPos.X.Scale,
                    startPos.X.Offset + delta.X,
                    startPos.Y.Scale,
                    startPos.Y.Offset + delta.Y
                )
            }, 0.15)
        end
    end)
end

-- Create Main GUI
local function CreateMainGUI(config)
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "TugaHub_" .. tostring(math.random(1000, 9999))
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    if gethui then
        ScreenGui.Parent = gethui()
    elseif syn and syn.protect_gui then
        syn.protect_gui(ScreenGui)
        ScreenGui.Parent = CoreGui
    else
        ScreenGui.Parent = CoreGui
    end

    -- Main Container
    local Main = Instance.new("Frame")
    Main.Name = "Main"
    Main.Size = UDim2.new(0, 680, 0, 480)
    Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = CurrentTheme.Background
    Main.BorderSizePixel = 0
    Main.ClipsDescendants = false
    Main.Parent = ScreenGui

    CreateCorner(Main, 14)
    CreateStroke(Main, CurrentTheme.Border, 1, 0.5)

    -- Shadow
    local Shadow = Instance.new("ImageLabel")
    Shadow.Name = "Shadow"
    Shadow.Size = UDim2.new(1, 40, 1, 40)
    Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    Shadow.BackgroundTransparency = 1
    Shadow.Image = "rbxassetid://1316045217"
    Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    Shadow.ImageTransparency = 0.65
    Shadow.ScaleType = Enum.ScaleType.Slice
    Shadow.SliceCenter = Rect.new(10, 10, 118, 118)
    Shadow.ZIndex = -1
    Shadow.Parent = Main

    -- Topbar
    local Topbar = Instance.new("Frame")
    Topbar.Name = "Topbar"
    Topbar.Size = UDim2.new(1, 0, 0, 50)
    Topbar.BackgroundColor3 = CurrentTheme.Surface
    Topbar.BorderSizePixel = 0
    Topbar.Parent = Main

    CreateCorner(Topbar, 14)

    local TopbarFix = Instance.new("Frame")
    TopbarFix.Size = UDim2.new(1, 0, 0, 14)
    TopbarFix.Position = UDim2.new(0, 0, 1, -14)
    TopbarFix.BackgroundColor3 = CurrentTheme.Surface
    TopbarFix.BorderSizePixel = 0
    TopbarFix.Parent = Topbar

    -- Logo
    local Logo = Instance.new("Frame")
    Logo.Name = "Logo"
    Logo.Size = UDim2.new(0, 40, 0, 40)
    Logo.Position = UDim2.new(0, 8, 0.5, 0)
    Logo.AnchorPoint = Vector2.new(0, 0.5)
    Logo.BackgroundColor3 = CurrentTheme.Primary
    Logo.BorderSizePixel = 0
    Logo.Parent = Topbar

    CreateCorner(Logo, 10)

    local LogoText = Instance.new("TextLabel")
    LogoText.Size = UDim2.new(1, 0, 1, 0)
    LogoText.BackgroundTransparency = 1
    LogoText.Text = "T"
    LogoText.Font = Enum.Font.GothamBlack
    LogoText.TextSize = 24
    LogoText.TextColor3 = Color3.fromRGB(255, 255, 255)
    LogoText.Parent = Logo

    -- Title
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(0, 150, 1, 0)
    Title.Position = UDim2.new(0, 55, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = config.Name or "TugaHub"
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Title.TextColor3 = CurrentTheme.Text
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Topbar

    local Subtitle = Instance.new("TextLabel")
    Subtitle.Size = UDim2.new(1, 0, 0, 12)
    Subtitle.Position = UDim2.new(0, 0, 1, -14)
    Subtitle.BackgroundTransparency = 1
    Subtitle.Text = "v" .. TugaHub.Version
    Subtitle.Font = Enum.Font.Gotham
    Subtitle.TextSize = 10
    Subtitle.TextColor3 = CurrentTheme.TextDim
    Subtitle.TextXAlignment = Enum.TextXAlignment.Left
    Subtitle.Parent = Title

    -- Controls
    local Controls = Instance.new("Frame")
    Controls.Name = "Controls"
    Controls.Size = UDim2.new(0, 110, 0, 32)
    Controls.Position = UDim2.new(1, -118, 0.5, 0)
    Controls.AnchorPoint = Vector2.new(0, 0.5)
    Controls.BackgroundTransparency = 1
    Controls.Parent = Topbar

    local ControlsLayout = Instance.new("UIListLayout")
    ControlsLayout.FillDirection = Enum.FillDirection.Horizontal
    ControlsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Right
    ControlsLayout.Padding = UDim.new(0, 6)
    ControlsLayout.Parent = Controls

    local function CreateControlBtn(icon, callback)
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(0, 32, 0, 32)
        btn.BackgroundColor3 = CurrentTheme.Sidebar
        btn.BorderSizePixel = 0
        btn.Text = icon
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 16
        btn.TextColor3 = CurrentTheme.TextDim
        btn.AutoButtonColor = false
        btn.Parent = Controls

        CreateCorner(btn, 8)

        btn.MouseEnter:Connect(function()
            Tween(btn, {BackgroundColor3 = CurrentTheme.Primary, TextColor3 = CurrentTheme.Text}, 0.2)
        end)

        btn.MouseLeave:Connect(function()
            Tween(btn, {BackgroundColor3 = CurrentTheme.Sidebar, TextColor3 = CurrentTheme.TextDim}, 0.2)
        end)

        btn.MouseButton1Click:Connect(callback)

        return btn
    end

    return ScreenGui, Main, Topbar, Controls, CreateControlBtn
end

-- Create Window
function TugaHub:CreateWindow(config)
    config = config or {}
    config.Name = config.Name or "TugaHub"
    config.Theme = config.Theme or "Portugal"
    config.LoadingEnabled = config.LoadingEnabled ~= false

    CurrentTheme = TugaHub.Themes[config.Theme] or TugaHub.Themes.Portugal

    local GUI, Main, Topbar, Controls, CreateControlBtn = CreateMainGUI(config)

    -- Loading Animation
    if config.LoadingEnabled then
        Main.Size = UDim2.new(0, 0, 0, 0)
        Main.Rotation = -90

        task.wait(0.1)

        Tween(Main, {
            Size = UDim2.new(0, 680, 0, 480),
            Rotation = 0
        }, 0.7, Enum.EasingStyle.Back):Play()

        task.wait(0.7)
    end

    local Window = {
        GUI = GUI,
        Main = Main,
        Tabs = {},
        CurrentTab = nil,
        Elements = {}
    }

    table.insert(TugaHub.Windows, Window)

    -- Mini button (created when close)
    local MiniButton

    -- Config Panel
    local ConfigFrame = Instance.new("Frame")
    ConfigFrame.Name = "Config"
    ConfigFrame.Size = UDim2.new(0, 250, 0, 260)
    ConfigFrame.Position = UDim2.new(1, 0, 0, 60)
    ConfigFrame.BackgroundColor3 = CurrentTheme.Surface
    ConfigFrame.BorderSizePixel = 0
    ConfigFrame.Visible = false
    ConfigFrame.Parent = Main

    CreateCorner(ConfigFrame, 10)
    CreateStroke(ConfigFrame, CurrentTheme.Border, 1, 0.5)

    -- Config Title
    local ConfigTitle = Instance.new("TextLabel")
    ConfigTitle.Size = UDim2.new(1, -16, 0, 30)
    ConfigTitle.Position = UDim2.new(0, 8, 0, 8)
    ConfigTitle.BackgroundTransparency = 1
    ConfigTitle.Text = "Configura√ß√µes"
    ConfigTitle.Font = Enum.Font.GothamBold
    ConfigTitle.TextSize = 16
    ConfigTitle.TextColor3 = CurrentTheme.Text
    ConfigTitle.Parent = ConfigFrame

    -- Credits
    local Credits = Instance.new("TextLabel")
    Credits.Size = UDim2.new(1, -16, 0, 20)
    Credits.Position = UDim2.new(0, 8, 1, -26)
    Credits.BackgroundTransparency = 1
    Credits.Text = "by Portuga_MTA"
    Credits.Font = Enum.Font.Gotham
    Credits.TextSize = 12
    Credits.TextColor3 = CurrentTheme.TextDim
    Credits.Parent = ConfigFrame

    -- Theme Button
    local ThemeButton = Instance.new("TextButton")
    ThemeButton.Size = UDim2.new(1, -16, 0, 40)
    ThemeButton.Position = UDim2.new(0, 8, 0, 50)
    ThemeButton.BackgroundColor3 = CurrentTheme.Background
    ThemeButton.Text = "Tema: " .. (config.Theme or "Portugal")
    ThemeButton.Font = Enum.Font.GothamSemibold
    ThemeButton.TextSize = 14
    ThemeButton.TextColor3 = CurrentTheme.Text
    ThemeButton.Parent = ConfigFrame
    CreateCorner(ThemeButton, 8)

    local themes = {"Portugal", "Dark", "Light"}
    ThemeButton.MouseButton1Click:Connect(function()
        local currentIndex = table.find(themes, config.Theme) or 1
        local nextTheme = themes[currentIndex % #themes + 1]
        config.Theme = nextTheme
        CurrentTheme = TugaHub.Themes[nextTheme]

        -- Update UI colors
        Main.BackgroundColor3 = CurrentTheme.Background
        Topbar.BackgroundColor3 = CurrentTheme.Surface
        ConfigFrame.BackgroundColor3 = CurrentTheme.Surface
        ThemeButton.BackgroundColor3 = CurrentTheme.Background
        ThemeButton.TextColor3 = CurrentTheme.Text
        ThemeButton.Text = "Tema: " .. nextTheme
        Credits.TextColor3 = CurrentTheme.TextDim
    end)

    -- Toggle Key Button
    local KeyButton = Instance.new("TextButton")
    KeyButton.Size = UDim2.new(1, -16, 0, 40)
    KeyButton.Position = UDim2.new(0, 8, 0, 100)
    KeyButton.BackgroundColor3 = CurrentTheme.Background
    KeyButton.Text = "Tecla: K"
    KeyButton.Font = Enum.Font.GothamSemibold
    KeyButton.TextSize = 14
    KeyButton.TextColor3 = CurrentTheme.Text
    KeyButton.Parent = ConfigFrame
    CreateCorner(KeyButton, 8)

    local keyOptions = {
        {Name="K", Key=Enum.KeyCode.K},
        {Name="RightShift", Key=Enum.KeyCode.RightShift},
        {Name="RightCtrl", Key=Enum.KeyCode.RightControl}
    }
    local keyIndex = 1

    KeyButton.MouseButton1Click:Connect(function()
        keyIndex = keyIndex % #keyOptions + 1
        ToggleKey = keyOptions[keyIndex].Key
        KeyButton.Text = "Tecla: " .. keyOptions[keyIndex].Name
    end)

    -- Sidebar
    local Sidebar = Instance.new("Frame")
    Sidebar.Name = "Sidebar"
    Sidebar.Size = UDim2.new(0, 160, 1, -58)
    Sidebar.Position = UDim2.new(0, 8, 0, 54)
    Sidebar.BackgroundColor3 = CurrentTheme.Sidebar
    Sidebar.BorderSizePixel = 0
    Sidebar.Parent = Main

    CreateCorner(Sidebar, 10)
    CreateStroke(Sidebar, CurrentTheme.Border, 1, 0.5)

    -- Search Bar
    local SearchBar = Instance.new("Frame")
    SearchBar.Name = "Search"
    SearchBar.Size = UDim2.new(1, -12, 0, 36)
    SearchBar.Position = UDim2.new(0, 6, 0, 6)
    SearchBar.BackgroundColor3 = CurrentTheme.Background
    SearchBar.BorderSizePixel = 0
    SearchBar.Parent = Sidebar

    CreateCorner(SearchBar, 8)

    local SearchIcon = Instance.new("TextLabel")
    SearchIcon.Size = UDim2.new(0, 30, 1, 0)
    SearchIcon.BackgroundTransparency = 1
    SearchIcon.Text = "üîç"
    SearchIcon.Font = Enum.Font.Gotham
    SearchIcon.TextSize = 14
    SearchIcon.TextColor3 = CurrentTheme.TextDim
    SearchIcon.Parent = SearchBar

    local SearchInput = Instance.new("TextBox")
    SearchInput.Size = UDim2.new(1, -35, 1, 0)
    SearchInput.Position = UDim2.new(0, 30, 0, 0)
    SearchInput.BackgroundTransparency = 1
    SearchInput.Text = ""
    SearchInput.PlaceholderText = "Procurar..."
    SearchInput.Font = Enum.Font.Gotham
    SearchInput.TextSize = 12
    SearchInput.TextColor3 = CurrentTheme.Text
    SearchInput.PlaceholderColor3 = CurrentTheme.TextDim
    SearchInput.TextXAlignment = Enum.TextXAlignment.Left
    SearchInput.ClearTextOnFocus = false
    SearchInput.Parent = SearchBar

    -- Tab Container
    local TabContainer = Instance.new("ScrollingFrame")
    TabContainer.Name = "Tabs"
    TabContainer.Size = UDim2.new(1, -12, 1, -50)
    TabContainer.Position = UDim2.new(0, 6, 0, 44)
    TabContainer.BackgroundTransparency = 1
    TabContainer.BorderSizePixel = 0
    TabContainer.ScrollBarThickness = 3
    TabContainer.ScrollBarImageColor3 = CurrentTheme.Primary
    TabContainer.CanvasSize = UDim2.new(0, 0, 0, 0)
    TabContainer.Parent = Sidebar

    local TabLayout = Instance.new("UIListLayout")
    TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    TabLayout.Padding = UDim.new(0, 4)
    TabLayout.Parent = TabContainer

    TabLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabContainer.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y + 8)
    end)

    -- Content Area
    local Content = Instance.new("Frame")
    Content.Name = "Content"
    Content.Size = UDim2.new(1, -180, 1, -58)
    Content.Position = UDim2.new(0, 172, 0, 54)
    Content.BackgroundColor3 = CurrentTheme.Surface
    Content.BorderSizePixel = 0
    Content.ClipsDescendants = true
    Content.Parent = Main

    CreateCorner(Content, 10)
    CreateStroke(Content, CurrentTheme.Border, 1, 0.5)

    MakeDraggable(Main, Topbar)

    -- Controls buttons
    local minimized = false

    -- Config button (‚öô)
    local ConfigOpen = false
    local ConfigBtn = CreateControlBtn("‚öô", function()
        ConfigOpen = not ConfigOpen
        ConfigFrame.Visible = ConfigOpen
        Tween(ConfigFrame, {
            Position = ConfigOpen and UDim2.new(1, -260, 0, 60) or UDim2.new(1, 0, 0, 60)
        }, 0.3)
    end)

    local MinBtn = CreateControlBtn("‚àí", function()
        minimized = not minimized
        if minimized then
            Tween(Main, {Size = UDim2.new(0, 680, 0, 50)}, 0.3, Enum.EasingStyle.Back)
        else
            Tween(Main, {Size = UDim2.new(0, 680, 0, 480)}, 0.3, Enum.EasingStyle.Back)
        end
    end)

    local CloseBtn = CreateControlBtn("√ó", function()
        Main.Visible = false

        if not MiniButton then
            MiniButton = Instance.new("TextButton")
            MiniButton.Size = UDim2.new(0, 45, 0, 45)
            MiniButton.Position = UDim2.new(1, -60, 1, -60)
            MiniButton.BackgroundColor3 = CurrentTheme.Primary
            MiniButton.Text = "T"
            MiniButton.Font = Enum.Font.GothamBlack
            MiniButton.TextSize = 18
            MiniButton.TextColor3 = Color3.new(1,1,1)
            MiniButton.Parent = GUI

            CreateCorner(MiniButton, 12)

            MiniButton.MouseButton1Click:Connect(function()
                Main.Visible = true
                Tween(Main, {Size = UDim2.new(0, 680, 0, 480)}, 0.4, Enum.EasingStyle.Back)
            end)
        end
    end)

    -- Search Functionality
    SearchInput:GetPropertyChangedSignal("Text"):Connect(function()
        local searchText = SearchInput.Text:lower()

        for _, tab in pairs(Window.Tabs) do
            if searchText == "" then
                tab.Button.Visible = true
            else
                tab.Button.Visible = tab.Name:lower():find(searchText, 1, true) ~= nil
            end
        end
    end)

    -- Toggle key for open/close
    UserInputService.InputBegan:Connect(function(input, gp)
        if gp then return end
        if input.KeyCode == ToggleKey then
            Main.Visible = not Main.Visible
        end
    end)

    -- FINAL DO CreateWindow
    return Window
end

-- Create Tab
function Window:CreateTab(name, icon)
    icon = icon or "üìÑ"

    local TabButton = Instance.new("TextButton")
    TabButton.Name = name
    TabButton.Size = UDim2.new(1, 0, 0, 42)
    TabButton.BackgroundColor3 = CurrentTheme.Background
    TabButton.BackgroundTransparency = 1
    TabButton.BorderSizePixel = 0
    TabButton.Text = ""
    TabButton.AutoButtonColor = false
    TabButton.Parent = TabContainer

    CreateCorner(TabButton, 8)

    local TabIcon = Instance.new("TextLabel")
    TabIcon.Name = "Icon"
    TabIcon.Size = UDim2.new(0, 32, 1, 0)
    TabIcon.Position = UDim2.new(0, 8, 0, 0)
    TabIcon.BackgroundTransparency = 1
    TabIcon.Text = icon
    TabIcon.Font = Enum.Font.GothamBold
    TabIcon.TextSize = 18
    TabIcon.TextColor3 = CurrentTheme.TextDim
    TabIcon.Parent = TabButton

    local TabLabel = Instance.new("TextLabel")
    TabLabel.Name = "Label"
    TabLabel.Size = UDim2.new(1, -45, 1, 0)
    TabLabel.Position = UDim2.new(0, 40, 0, 0)
    TabLabel.BackgroundTransparency = 1
    TabLabel.Text = name
    TabLabel.Font = Enum.Font.GothamSemibold
    TabLabel.TextSize = 13
    TabLabel.TextColor3 = CurrentTheme.TextDim
    TabLabel.TextXAlignment = Enum.TextXAlignment.Left
    TabLabel.Parent = TabButton

    -- Tab Content
    local TabContent = Instance.new("ScrollingFrame")
    TabContent.Name = name .. "_Content"
    TabContent.Size = UDim2.new(1, -16, 1, -16)
    TabContent.Position = UDim2.new(0, 8, 0, 8)
    TabContent.BackgroundTransparency = 1
    TabContent.BorderSizePixel = 0
    TabContent.ScrollBarThickness = 4
    TabContent.ScrollBarImageColor3 = CurrentTheme.Primary
    TabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
    TabContent.Visible = false
    TabContent.Parent = Content

    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ContentLayout.Padding = UDim.new(0, 10)
    ContentLayout.Parent = TabContent

    ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabContent.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 16)
    end)

    -- Selection Logic
    local function SelectTab()
        for _, tab in pairs(Window.Tabs) do
            Tween(tab.Button, {BackgroundTransparency = 1}, 0.2)
            Tween(tab.Icon, {TextColor3 = CurrentTheme.TextDim}, 0.2)
            Tween(tab.Label, {TextColor3 = CurrentTheme.TextDim}, 0.2)
            tab.Content.Visible = false
        end

        Tween(TabButton, {BackgroundTransparency = 0}, 0.2)
        Tween(TabIcon, {TextColor3 = CurrentTheme.Primary}, 0.2)
        Tween(TabLabel, {TextColor3 = CurrentTheme.Text}, 0.2)
        TabContent.Visible = true

        Window.CurrentTab = name
    end

    TabButton.MouseButton1Click:Connect(SelectTab)

    TabButton.MouseEnter:Connect(function()
        if Window.CurrentTab ~= name then
            Tween(TabButton, {BackgroundTransparency = 0.5}, 0.2)
        end
    end)

    TabButton.MouseLeave:Connect(function()
        if Window.CurrentTab ~= name then
            Tween(TabButton, {BackgroundTransparency = 1}, 0.2)
        end
    end)

    local Tab = {
        Name = name,
        Button = TabButton,
        Icon = TabIcon,
        Label = TabLabel,
        Content = TabContent
    }

    Window.Tabs[name] = Tab

    -- Select first tab
    if #TabContainer:GetChildren() == 2 then
        task.wait(0.05)
        SelectTab()
    end

    -- Tab Elements
    local Elements = {}

    -- Section
    function Elements:CreateSection(title)
        local Section = Instance.new("Frame")
        Section.Name = "Section"
        Section.Size = UDim2.new(1, 0, 0, 35)
        Section.BackgroundTransparency = 1
        Section.Parent = TabContent

        local SectionLabel = Instance.new("TextLabel")
        SectionLabel.Size = UDim2.new(1, -10, 1, 0)
        SectionLabel.Position = UDim2.new(0, 5, 0, 0)
        SectionLabel.BackgroundTransparency = 1
        SectionLabel.Text = "‚îÅ‚îÅ " .. title .. " ‚îÅ‚îÅ"
        SectionLabel.Font = Enum.Font.GothamBold
        SectionLabel.TextSize = 14
        SectionLabel.TextColor3 = CurrentTheme.Primary
        SectionLabel.Parent = Section

        return Section
    end

    -- Button
    function Elements:CreateButton(config)
        config = config or {}
        config.Name = config.Name or "Button"
        config.Callback = config.Callback or function() end

        local Button = Instance.new("TextButton")
        Button.Name = "Button"
        Button.Size = UDim2.new(1, 0, 0, 45)
        Button.BackgroundColor3 = CurrentTheme.Background
        Button.BorderSizePixel = 0
        Button.Text = ""
        Button.AutoButtonColor = false
        Button.Parent = TabContent

        CreateCorner(Button, 8)
        CreateStroke(Button, CurrentTheme.Border, 1, 0.5)

        local ButtonLabel = Instance.new("TextLabel")
        ButtonLabel.Size = UDim2.new(1, -50, 1, 0)
        ButtonLabel.Position = UDim2.new(0, 12, 0, 0)
        ButtonLabel.BackgroundTransparency = 1
        ButtonLabel.Text = config.Name
        ButtonLabel.Font = Enum.Font.GothamSemibold
        ButtonLabel.TextSize = 14
        ButtonLabel.TextColor3 = CurrentTheme.Text
        ButtonLabel.TextXAlignment = Enum.TextXAlignment.Left
        ButtonLabel.Parent = Button

        local ButtonIcon = Instance.new("TextLabel")
        ButtonIcon.Size = UDim2.new(0, 35, 1, 0)
        ButtonIcon.Position = UDim2.new(1, -40, 0, 0)
        ButtonIcon.BackgroundTransparency = 1
        ButtonIcon.Text = "‚ñ∂"
        ButtonIcon.Font = Enum.Font.GothamBold
        ButtonIcon.TextSize = 14
        ButtonIcon.TextColor3 = CurrentTheme.Primary
        ButtonIcon.Parent = Button

        Button.MouseEnter:Connect(function()
            Tween(Button, {BackgroundColor3 = CurrentTheme.Sidebar}, 0.2)
            Tween(Button.UIStroke, {Transparency = 0}, 0.2)
        end)

        Button.MouseLeave:Connect(function()
            Tween(Button, {BackgroundColor3 = CurrentTheme.Background}, 0.2)
            Tween(Button.UIStroke, {Transparency = 0.5}, 0.2)
        end)

        Button.MouseButton1Click:Connect(function()
            Tween(Button, {BackgroundColor3 = CurrentTheme.Primary}, 0.1)
            Tween(ButtonLabel, {TextColor3 = Color3.fromRGB(255, 255, 255)}, 0.1)
            task.wait(0.15)
            Tween(Button, {BackgroundColor3 = CurrentTheme.Background}, 0.2)
            Tween(ButtonLabel, {TextColor3 = CurrentTheme.Text}, 0.2)

            pcall(config.Callback)
        end)

        return Button
    end

    -- Toggle
    function Elements:CreateToggle(config)
        config = config or {}
        config.Name = config.Name or "Toggle"
        config.Default = config.Default or false
        config.Callback = config.Callback or function() end

        local Toggle = Instance.new("Frame")
        Toggle.Name = "Toggle"
        Toggle.Size = UDim2.new(1, 0, 0, 45)
        Toggle.BackgroundColor3 = CurrentTheme.Background
        Toggle.BorderSizePixel = 0
        Toggle.Parent = TabContent

        CreateCorner(Toggle, 8)
        CreateStroke(Toggle, CurrentTheme.Border, 1, 0.5)

        local ToggleLabel = Instance.new("TextLabel")
        ToggleLabel.Size = UDim2.new(1, -70, 1, 0)
        ToggleLabel.Position = UDim2.new(0, 12, 0, 0)
        ToggleLabel.BackgroundTransparency = 1
        ToggleLabel.Text = config.Name
        ToggleLabel.Font = Enum.Font.GothamSemibold
        ToggleLabel.TextSize = 14
        ToggleLabel.TextColor3 = CurrentTheme.Text
        ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
        ToggleLabel.Parent = Toggle

        local ToggleButton = Instance.new("TextButton")
        ToggleButton.Size = UDim2.new(0, 50, 0, 26)
        ToggleButton.Position = UDim2.new(1, -58, 0.5, 0)
        ToggleButton.AnchorPoint = Vector2.new(0, 0.5)
        ToggleButton.BackgroundColor3 = CurrentTheme.Sidebar
        ToggleButton.BorderSizePixel = 0
        ToggleButton.Text = ""
        ToggleButton.AutoButtonColor = false
        ToggleButton.Parent = Toggle

        CreateCorner(ToggleButton, 13)
        CreateStroke(ToggleButton, CurrentTheme.Border, 1, 0.5)

        local Knob = Instance.new("Frame")
        Knob.Size = UDim2.new(0, 22, 0, 22)
        Knob.Position = UDim2.new(0, 2, 0.5, 0)
        Knob.AnchorPoint = Vector2.new(0, 0.5)
        Knob.BackgroundColor3 = CurrentTheme.Primary
        Knob.BorderSizePixel = 0
        Knob.Parent = ToggleButton

        CreateCorner(Knob, 11)

        local enabled = config.Default
        if enabled then
            Knob.Position = UDim2.new(1, -24, 0.5, 0)
            ToggleButton.BackgroundColor3 = CurrentTheme.Primary
        end

        local function SetState(state)
            enabled = state
            Tween(Knob, {Position = enabled and UDim2.new(1, -24, 0.5, 0) or UDim2.new(0, 2, 0.5, 0)}, 0.2)
            Tween(ToggleButton, {BackgroundColor3 = enabled and CurrentTheme.Primary or CurrentTheme.Sidebar}, 0.2)
            pcall(config.Callback, enabled)
        end

        ToggleButton.MouseButton1Click:Connect(function()
            SetState(not enabled)
        end)

        return Toggle, function() return enabled end, SetState
    end

    -- Slider
    function Elements:CreateSlider(config)
        config = config or {}
        config.Name = config.Name or "Slider"
        config.Min = config.Min or 0
        config.Max = config.Max or 100
        config.Default = config.Default or 0
        config.Callback = config.Callback or function() end

        local Slider = Instance.new("Frame")
        Slider.Name = "Slider"
        Slider.Size = UDim2.new(1, 0, 0, 55)
        Slider.BackgroundTransparency = 1
        Slider.Parent = TabContent

        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -10, 0, 18)
        Label.Position = UDim2.new(0, 5, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = config.Name
        Label.Font = Enum.Font.GothamSemibold
        Label.TextSize = 14
        Label.TextColor3 = CurrentTheme.Text
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Slider

        local Bar = Instance.new("Frame")
        Bar.Size = UDim2.new(1, -10, 0, 12)
        Bar.Position = UDim2.new(0, 5, 0, 30)
        Bar.BackgroundColor3 = CurrentTheme.Sidebar
        Bar.BorderSizePixel = 0
        Bar.Parent = Slider

        CreateCorner(Bar, 6)

        local Fill = Instance.new("Frame")
        Fill.Size = UDim2.new(0, 0, 1, 0)
        Fill.BackgroundColor3 = CurrentTheme.Primary
        Fill.BorderSizePixel = 0
        Fill.Parent = Bar

        CreateCorner(Fill, 6)

        local ValueLabel = Instance.new("TextLabel")
        ValueLabel.Size = UDim2.new(0, 50, 1, 0)
        ValueLabel.Position = UDim2.new(1, 5, 0, 0)
        ValueLabel.BackgroundTransparency = 1
        ValueLabel.Text = tostring(config.Default)
        ValueLabel.Font = Enum.Font.Gotham
        ValueLabel.TextSize = 12
        ValueLabel.TextColor3 = CurrentTheme.TextDim
        ValueLabel.TextXAlignment = Enum.TextXAlignment.Left
        ValueLabel.Parent = Slider

        local dragging = false
        local function SetValue(x)
            local barPos = Bar.AbsolutePosition.X
            local barSize = Bar.AbsoluteSize.X
            local ratio = math.clamp((x - barPos) / barSize, 0, 1)
            local value = math.floor(config.Min + (config.Max - config.Min) * ratio)

            Fill.Size = UDim2.new(ratio, 0, 1, 0)
            ValueLabel.Text = tostring(value)
            pcall(config.Callback, value)
        end

        Bar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                SetValue(input.Position.X)
            end
        end)

        Bar.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
                SetValue(input.Position.X)
            end
        end)

        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        return Slider
    end

    -- Textbox
    function Elements:CreateTextbox(config)
        config = config or {}
        config.Name = config.Name or "Textbox"
        config.Placeholder = config.Placeholder or ""
        config.Callback = config.Callback or function() end

        local Box = Instance.new("Frame")
        Box.Name = "Textbox"
        Box.Size = UDim2.new(1, 0, 0, 45)
        Box.BackgroundColor3 = CurrentTheme.Background
        Box.BorderSizePixel = 0
        Box.Parent = TabContent

        CreateCorner(Box, 8)
        CreateStroke(Box, CurrentTheme.Border, 1, 0.5)

        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -10, 0, 18)
        Label.Position = UDim2.new(0, 5, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = config.Name
        Label.Font = Enum.Font.GothamSemibold
        Label.TextSize = 14
        Label.TextColor3 = CurrentTheme.Text
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Box

        local TextBox = Instance.new("TextBox")
        TextBox.Size = UDim2.new(1, -10, 0, 22)
        TextBox.Position = UDim2.new(0, 5, 0, 22)
        TextBox.BackgroundColor3 = CurrentTheme.Surface
        TextBox.BorderSizePixel = 0
        TextBox.Text = ""
        TextBox.PlaceholderText = config.Placeholder
        TextBox.Font = Enum.Font.Gotham
        TextBox.TextSize = 12
        TextBox.TextColor3 = CurrentTheme.Text
        TextBox.Parent = Box

        CreateCorner(TextBox, 6)

        TextBox.FocusLost:Connect(function(enter)
            if enter then
                pcall(config.Callback, TextBox.Text)
            end
        end)

        return TextBox
    end

    -- Dropdown
    function Elements:CreateDropdown(config)
        config = config or {}
        config.Name = config.Name or "Dropdown"
        config.Options = config.Options or {}
        config.Callback = config.Callback or function() end

        local Drop = Instance.new("Frame")
        Drop.Name = "Dropdown"
        Drop.Size = UDim2.new(1, 0, 0, 45)
        Drop.BackgroundColor3 = CurrentTheme.Background
        Drop.BorderSizePixel = 0
        Drop.Parent = TabContent

        CreateCorner(Drop, 8)
        CreateStroke(Drop, CurrentTheme.Border, 1, 0.5)

        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -10, 1, 0)
        Label.Position = UDim2.new(0, 5, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = config.Name
        Label.Font = Enum.Font.GothamSemibold
        Label.TextSize = 14
        Label.TextColor3 = CurrentTheme.Text
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Drop

        local Arrow = Instance.new("TextLabel")
        Arrow.Size = UDim2.new(0, 20, 1, 0)
        Arrow.Position = UDim2.new(1, -25, 0, 0)
        Arrow.BackgroundTransparency = 1
        Arrow.Text = "‚ñæ"
        Arrow.Font = Enum.Font.Gotham
        Arrow.TextSize = 14
        Arrow.TextColor3 = CurrentTheme.TextDim
        Arrow.Parent = Drop

        local Selected = Instance.new("TextLabel")
        Selected.Size = UDim2.new(1, -40, 1, 0)
        Selected.Position = UDim2.new(0, 10, 0, 0)
        Selected.BackgroundTransparency = 1
        Selected.Text = config.Options[1] or "Nenhum"
        Selected.Font = Enum.Font.Gotham
        Selected.TextSize = 14
        Selected.TextColor3 = CurrentTheme.TextDim
        Selected.TextXAlignment = Enum.TextXAlignment.Left
        Selected.Parent = Drop

        local List = Instance.new("Frame")
        List.Name = "List"
        List.Size = UDim2.new(1, 0, 0, 0)
        List.Position = UDim2.new(0, 0, 1, 2)
        List.BackgroundColor3 = CurrentTheme.Surface
        List.BorderSizePixel = 0
        List.ClipsDescendants = true
        List.Parent = Drop

        CreateCorner(List, 8)
        CreateStroke(List, CurrentTheme.Border, 1, 0.5)

        local ListLayout = Instance.new("UIListLayout")
        ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
        ListLayout.Padding = UDim.new(0, 2)
        ListLayout.Parent = List

        local open = false
        local function ToggleList()
            open = not open
            Tween(List, {Size = open and UDim2.new(1, 0, 0, #config.Options * 30 + 10) or UDim2.new(1, 0, 0, 0)}, 0.2)
            Tween(Arrow, {Rotation = open and 180 or 0}, 0.2)
        end

        Drop.MouseButton1Click:Connect(ToggleList)

        for _, option in ipairs(config.Options) do
            local optBtn = Instance.new("TextButton")
            optBtn.Size = UDim2.new(1, -10, 0, 30)
            optBtn.Position = UDim2.new(0, 5, 0, 0)
            optBtn.BackgroundColor3 = CurrentTheme.Background
            optBtn.BorderSizePixel = 0
            optBtn.Text = option
            optBtn.Font = Enum.Font.Gotham
            optBtn.TextSize = 14
            optBtn.TextColor3 = CurrentTheme.Text
            optBtn.AutoButtonColor = false
            optBtn.Parent = List

            CreateCorner(optBtn, 6)

            optBtn.MouseEnter:Connect(function()
                Tween(optBtn, {BackgroundColor3 = CurrentTheme.Sidebar}, 0.2)
            end)
            optBtn.MouseLeave:Connect(function()
                Tween(optBtn, {BackgroundColor3 = CurrentTheme.Background}, 0.2)
            end)

            optBtn.MouseButton1Click:Connect(function()
                Selected.Text = option
                pcall(config.Callback, option)
                ToggleList()
            end)
        end

        return Drop
    end

    Window.Elements[name] = Elements
    return Elements
end

-- Notify (kept minimal and compatible)
function Window:Notify(data)
    data = data or {}
    local title = data.Title or "Notifica√ß√£o"
    local desc = data.Description or ""
    local duration = data.Duration or 3

    local Notify = Instance.new("Frame")
    Notify.Name = "Notify"
    Notify.Size = UDim2.new(0, 300, 0, 70)
    Notify.Position = UDim2.new(1, -320, 0, 20)
    Notify.BackgroundColor3 = CurrentTheme.Surface
    Notify.BorderSizePixel = 0
    Notify.Parent = Window.GUI

    CreateCorner(Notify, 10)
    CreateStroke(Notify, CurrentTheme.Border, 1, 0.5)

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, -20, 0, 22)
    TitleLabel.Position = UDim2.new(0, 10, 0, 8)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = title
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 14
    TitleLabel.TextColor3 = CurrentTheme.Text
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.Parent = Notify

    local DescLabel = Instance.new("TextLabel")
    DescLabel.Size = UDim2.new(1, -20, 0, 30)
    DescLabel.Position = UDim2.new(0, 10, 0, 30)
    DescLabel.BackgroundTransparency = 1
    DescLabel.Text = desc
    DescLabel.Font = Enum.Font.Gotham
    DescLabel.TextSize = 12
    DescLabel.TextColor3 = CurrentTheme.TextDim
    DescLabel.TextXAlignment = Enum.TextXAlignment.Left
    DescLabel.TextWrapped = true
    DescLabel.Parent = Notify

    Tween(Notify, {Position = UDim2.new(1, -320, 0, 20), BackgroundTransparency = 0}, 0.2)
    task.wait(duration)
    Tween(Notify, {Position = UDim2.new(1, 0, 0, 20), BackgroundTransparency = 1}, 0.2)
    task.wait(0.2)
    Notify:Destroy()
end

-- Return TugaHub
return TugaHub
